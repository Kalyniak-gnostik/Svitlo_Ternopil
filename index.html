<!DOCTYPE html>
<html lang="uk">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6DZW6D0LRN"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-6DZW6D0LRN');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <title>–ì—Ä–∞—Ñ—ñ–∫ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å–≤—ñ—Ç–ª–∞ –¢–µ—Ä–Ω–æ–ø—ñ–ª—å (–ì–ü–í) | –û–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞–∂–∏–≤–æ</title>
    <meta name="description" content="–ê–∫—Ç—É–∞–ª—å–Ω–∏–π –≥—Ä–∞—Ñ—ñ–∫ –ø–æ–≥–æ–¥–∏–Ω–Ω–∏—Ö –≤—ñ–¥–∫–ª—é—á–µ–Ω—å –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó (–ì–ü–í) –≤ –¢–µ—Ä–Ω–æ–ø–æ–ª—ñ —Ç–∞ –æ–±–ª–∞—Å—Ç—ñ. –ü–æ—à—É–∫ —á–µ—Ä–≥–∏ –∑–∞ –∞–¥—Ä–µ—Å–æ—é. –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ —Ç–∞ –∑–∞–≤—Ç—Ä–∞. –í—Å—ñ –≥—Ä—É–ø–∏.">
    <meta name="keywords" content="—Å–≤—ñ—Ç–ª–æ —Ç–µ—Ä–Ω–æ–ø—ñ–ª—å, –≥—Ä–∞—Ñ—ñ–∫ –≤—ñ–¥–∫–ª—é—á–µ–Ω—å, –≥–ø–≤ —Ç–µ—Ä–Ω–æ–ø—ñ–ª—å, –∫–æ–ª–∏ –±—É–¥–µ —Å–≤—ñ—Ç–ª–æ, —Ç–µ—Ä–Ω–æ–ø—ñ–ª—å–æ–±–ª–µ–Ω–µ—Ä–≥–æ –≥—Ä–∞—Ñ—ñ–∫, —á–µ—Ä–≥–∏ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è, 6 —á–µ—Ä–≥">
    <meta name="robots" content="index, follow">
    <meta name="author" content="Svitlo Ternopil">
    <link rel="canonical" href="https://grafik-svitla-ternopil.pp.ua">
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://grafik-svitla-ternopil.pp.ua">
    <meta property="og:title" content="–°–≤—ñ—Ç–ª–æ –¢–µ—Ä–Ω–æ–ø—ñ–ª—å: –ó–Ω–∞–π–¥–∏ —Å–≤–æ—é —á–µ—Ä–≥—É">
    <meta property="og:description" content="–î—ñ–∑–Ω–∞–π—Å—è –≥—Ä–∞—Ñ—ñ–∫ –≤—ñ–¥–∫–ª—é—á–µ–Ω—å –∑–∞ 1 —Ö–≤–∏–ª–∏–Ω—É. –ü–æ—à—É–∫ –ø–æ –≤—É–ª–∏—Ü—ñ. –ê–∫—Ç—É–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ –æ–±–ª–µ–Ω–µ—Ä–≥–æ.">
    <meta property="og:image" content="https://raw.githubusercontent.com/kalyniak-gnostik/Svitlo_Ternopil/main/og-image.png">
    
    <meta name="theme-color" content="#f5f5f7" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%239b59b6'/%3E%3Cpath d='M58 15 L28 52 H52 L42 85 L72 40 H48 Z' fill='%23f1c40f' stroke='white' stroke-width='2' stroke-linejoin='round'/%3E%3C/svg%3E">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "–ì—Ä–∞—Ñ—ñ–∫ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å–≤—ñ—Ç–ª–∞ –¢–µ—Ä–Ω–æ–ø—ñ–ª—å",
      "description": "–°–µ—Ä–≤—ñ—Å –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≥—Ä–∞—Ñ—ñ–∫—É –ø–æ–≥–æ–¥–∏–Ω–Ω–∏—Ö –≤—ñ–¥–∫–ª—é—á–µ–Ω—å –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó —É –º—ñ—Å—Ç—ñ –¢–µ—Ä–Ω–æ–ø—ñ–ª—å —Ç–∞ –æ–±–ª–∞—Å—Ç—ñ.",
      "applicationCategory": "UtilitiesApplication",
      "operatingSystem": "All",
      "offers": { "@type": "Offer", "price": "0", "priceCurrency": "UAH" }
    }
    </script>

    <style>
        /* === DESIGN SYSTEM === */
        :root {
            --font-main: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Inter", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            
            /* Light Theme Defaults */
            --bg-body: #f5f5f7;
            --bg-card: #ffffff;
            --bg-glass: rgba(255, 255, 255, 0.85);
            --bg-input: #f0f0f5;
            
            --text-main: #1d1d1f;
            --text-sub: #86868b;
            --border: #d2d2d7;

            /* Accent Colors */
            --accent: #9b59b6; 
            --accent-hover: #8e44ad;
            --accent-glow: rgba(155, 89, 182, 0.4);
            
            --green: #34c759; --green-bg: #e1fae6;
            --red: #ff3b30; --red-bg: #ffebeb;
            --yellow: #ffcc00; --yellow-bg: #fff9d6;
            
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.04);
            --shadow-lg: 0 12px 30px rgba(0,0,0,0.08);
            
            --radius-lg: 22px;
            --radius-md: 14px;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-body: #000000;
                --bg-card: #1c1c1e;
                --bg-glass: rgba(28, 28, 30, 0.85);
                --bg-input: #2c2c2e;
                
                --text-main: #f5f5f7;
                --text-sub: #98989d;
                --border: #38383a;
                
                --shadow-sm: 0 2px 8px rgba(0,0,0,0.2);
                --shadow-lg: 0 12px 30px rgba(0,0,0,0.3);

                --green-bg: rgba(52, 199, 89, 0.15);
                --red-bg: rgba(255, 59, 48, 0.15);
                --yellow-bg: rgba(255, 204, 0, 0.15);
            }
        }

        /* === RESET & BASE === */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; padding: 0; 
            font-family: var(--font-main); 
            background: var(--bg-body); 
            color: var(--text-main); 
            min-height: 100vh; 
            display: flex; flex-direction: column;
            overflow-x: hidden;
        }
        
        .container { 
            max-width: 640px; 
            margin: 0 auto; 
            padding: 20px 16px; 
            width: 100%; 
            flex: 1; 
            display: flex; flex-direction: column; 
        }

        /* === HEADER === */
        header { 
            display: flex; flex-direction: column; align-items: center; margin-bottom: 24px; text-align: center;
        }
        h1 { 
            margin: 12px 0 8px 0; 
            font-size: 26px; 
            font-weight: 800; 
            letter-spacing: -0.5px; 
        }
        
        .status-badge { 
            background: var(--bg-card); padding: 8px 16px; border-radius: 30px; 
            font-size: 13px; font-weight: 600; color: var(--text-sub); 
            display: flex; align-items: center; gap: 8px; 
            box-shadow: var(--shadow-sm);
            border: 1px solid rgba(0,0,0,0.03);
        }
        .dot { width: 8px; height: 8px; background: var(--green); border-radius: 50%; animation: pulse 2s infinite; }
        .dot.error { background: var(--red); animation: none; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(52, 199, 89, 0.4); } 70% { box-shadow: 0 0 0 6px rgba(52, 199, 89, 0); } 100% { box-shadow: 0 0 0 0 rgba(52, 199, 89, 0); } }

        /* === ACTIONS === */
        .actions-grid { 
            display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 24px; 
        }
        .btn-main {
            border: none; padding: 16px; border-radius: var(--radius-md);
            font-weight: 700; font-size: 15px; cursor: pointer; transition: transform 0.1s, box-shadow 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            text-decoration: none;
            position: relative; overflow: hidden;
        }
        .btn-main:active { transform: scale(0.97); }

        .btn-tg { 
            background: #229ED9; color: white; 
            box-shadow: 0 4px 15px rgba(34, 158, 217, 0.3); 
        }
        
        /* Updated Search Button Style */
        .btn-search { 
            background: var(--accent); color: white; 
            box-shadow: 0 4px 15px var(--accent-glow);
        }

        /* === GROUP SCROLLER (Infinite & Smooth) === */
        .scroller-container {
            margin-bottom: 30px;
        }
        
        /* Wrapper for the track */
        .group-track-wrapper {
            position: relative;
            margin: 0 -16px; /* Bleed to edges */
            height: 70px; 
            overflow: hidden;
            /* Fade edges */
            mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
            -webkit-mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
        }

        .group-track {
            display: flex;
            gap: 12px;
            padding: 0 50%; /* Center start */
            align-items: center;
            overflow-x: auto;
            scroll-behavior: auto; /* JS handles smoothness */
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Firefox */
            cursor: grab;
            user-select: none;
            position: absolute; left: 0; right: 0; top: 0; bottom: 0;
        }
        .group-track::-webkit-scrollbar { display: none; }
        .group-track:active { cursor: grabbing; }

        .btn-group {
            flex: 0 0 auto;
            width: 56px; height: 56px;
            background: var(--bg-card);
            border-radius: 18px;
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 16px; color: var(--text-sub);
            border: 2px solid transparent;
            box-shadow: var(--shadow-sm);
            transition: all 0.2s;
        }
        
        .btn-group.active {
            background: var(--bg-card);
            color: var(--accent);
            border-color: var(--accent);
            box-shadow: 0 4px 15px var(--accent-glow);
            transform: scale(1.1);
            z-index: 2;
        }

        .scroll-hint {
            text-align: center;
            font-size: 12px; color: var(--text-sub);
            margin-top: 8px; opacity: 0.7;
            font-weight: 500;
        }

        /* === MAIN CARD === */
        .card {
            background: var(--bg-card); border-radius: var(--radius-lg);
            padding: 24px; box-shadow: var(--shadow-lg); margin-bottom: 30px;
            display: flex; flex-direction: column; align-items: center;
            animation: fadeIn 0.4s ease-out;
            border: 1px solid rgba(0,0,0,0.03);
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Day Switcher */
        .day-switch {
            background: var(--bg-input); padding: 5px; border-radius: 18px;
            display: flex; width: 100%; margin-bottom: 24px;
        }
        .day-opt {
            flex: 1; border: none; background: transparent; padding: 12px;
            border-radius: 14px; font-weight: 700; font-size: 14px;
            color: var(--text-sub); cursor: pointer; transition: 0.2s;
            display: flex; flex-direction: column; align-items: center; line-height: 1.2;
        }
        .day-opt span { font-size: 11px; opacity: 0.8; margin-top: 2px; font-weight: 500; }
        
        /* Active State for Day Switcher - Purple */
        .day-opt.active {
            background: var(--accent); 
            color: white;
            box-shadow: 0 4px 12px var(--accent-glow);
        }
        .day-opt.active span { color: rgba(255,255,255,0.9); opacity: 1; }
        .day-opt.disabled { opacity: 0.4; cursor: not-allowed; }

        /* === MESSAGE NO SCHEDULE (NEW) === */
        .no-sched-msg {
            display: none; /* –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ */
            width: 100%;
            text-align: center;
            background: var(--bg-input);
            color: var(--text-sub);
            padding: 12px;
            border-radius: var(--radius-md);
            margin-bottom: 20px;
            font-size: 14px;
            font-weight: 600;
            animation: fadeIn 0.3s;
        }

        /* Big Group Badge */
        .group-display {
            width: 100%; text-align: center; margin-bottom: 20px;
        }
        .group-display-inner {
            display: inline-flex; align-items: center; justify-content: center;
            width: 80px; height: 80px;
            border-radius: 26px;
            background: var(--bg-body);
            color: var(--accent);
            font-size: 32px; font-weight: 900;
            box-shadow: inset 0 2px 6px rgba(0,0,0,0.05);
            border: 2px solid var(--accent);
        }
        .group-display-label {
            display: block; font-size: 12px; color: var(--text-sub); 
            text-transform: uppercase; letter-spacing: 1px; font-weight: 700;
            margin-bottom: 10px;
        }

        /* Timeline List */
        .schedule-list { width: 100%; display: flex; flex-direction: column; gap: 0; position: relative; }
        .schedule-list::before {
            content: ''; position: absolute; left: 28px; top: 15px; bottom: 15px;
            width: 2px; background: var(--bg-input); z-index: 0;
        }

        .row {
            display: flex; align-items: center; gap: 16px;
            padding: 12px 0; position: relative; z-index: 1;
        }
        
        .time-box {
            background: var(--bg-card);
            border: 2px solid var(--bg-input);
            width: 60px; text-align: center; padding: 6px 0;
            border-radius: 10px; font-weight: 700; font-size: 13px;
            color: var(--text-main);
            box-shadow: var(--shadow-sm);
        }

        .status-box {
            flex: 1; padding: 14px 18px; border-radius: 16px;
            display: flex; justify-content: space-between; align-items: center;
            font-weight: 600; font-size: 15px;
        }
        
        .row.on .status-box { background: var(--green-bg); color: var(--green); }
        .row.on .time-box { border-color: var(--green); color: var(--green); }
        
        .row.off .status-box { background: var(--red-bg); color: var(--red); }
        .row.off .time-box { border-color: var(--red); color: var(--red); }
        
        .row.maybe .status-box { background: var(--yellow-bg); color: #dcb000; }
        .row.maybe .time-box { border-color: var(--yellow); color: #dcb000; }

        .row-dur { opacity: 0.8; font-size: 13px; font-weight: 500; }
        .empty-state { text-align: center; color: var(--text-sub); padding: 40px 0; font-style: italic; width: 100%; }

        .btn-share {
            margin-top: 24px; width: 100%; padding: 16px; border-radius: var(--radius-md);
            border: 2px dashed var(--accent); background: rgba(155, 89, 182, 0.05);
            color: var(--accent); font-weight: 700; cursor: pointer;
            transition: 0.2s;
        }
        .btn-share:hover { background: var(--accent); color: white; border-style: solid; }

        /* === ACCORDION (Matrix) === */
        .accordion-btn {
            width: 100%; background: transparent; border: none;
            color: var(--text-sub); font-weight: 600; padding: 20px;
            cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;
            transition: color 0.2s;
        }
        .accordion-btn:hover { color: var(--text-main); }
        
        .full-chart {
            display: none; background: var(--bg-card); padding: 20px;
            border-radius: var(--radius-lg); margin-top: 10px;
            box-shadow: var(--shadow-sm);
            animation: fadeIn 0.3s;
        }
        .full-chart.open { display: block; }
        
        .chart-row { display: flex; height: 40px; margin-bottom: 10px; cursor: pointer; }
        .chart-row:active { transform: scale(0.98); }
        .lbl { width: 40px; display: flex; align-items: center; font-weight: 800; font-size: 13px; color: var(--text-sub); }
        .bar { flex: 1; display: flex; border-radius: 8px; overflow: hidden; }
        .cell { flex: 1; border-right: 1px solid rgba(255,255,255,0.1); transition: opacity 0.2s; }
        .cell.on { background: var(--green); } 
        .cell.off { background: var(--red); } 
        .cell.maybe { background: var(--yellow); } 
        .cell.u { background: var(--bg-input); }

        /* === FOOTER === */
        footer { margin-top: auto; padding-top: 40px; padding-bottom: 20px; text-align: center; color: var(--text-sub); font-size: 13px; line-height: 1.6; border-top: 1px solid rgba(0,0,0,0.05); }
        footer h2 { font-size: 14px; color: var(--text-main); margin-bottom: 8px; }
        footer p { margin: 0 0 10px 0; max-width: 500px; margin-inline: auto; }

        /* === WIZARD (SEARCH MODAL) === */
        .wiz-overlay { 
            display: none; position: fixed; top:0; left:0; width:100%; height:100%; 
            background: rgba(0,0,0,0.4); 
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            z-index: 999; justify-content: center; align-items: center;
            animation: fadeIn 0.2s;
        }
        .wiz-box { 
            background: var(--bg-card); width: 90%; max-width: 450px; 
            border-radius: 28px; overflow: hidden; 
            box-shadow: var(--shadow-lg);
            display: flex; flex-direction: column; 
            max-height: 80vh; 
            animation: fadeIn 0.3s;
        }
        .wiz-head { 
            padding: 20px 24px; border-bottom: 1px solid var(--bg-input); 
            font-weight: 800; font-size: 18px; 
            display: flex; justify-content: space-between; align-items: center;
        }
        .wiz-close { cursor: pointer; padding: 5px; color: var(--text-sub); font-size: 24px; line-height: 0.5; }
        
        .wiz-body { padding: 20px; overflow-y: auto; }
        
        .wiz-input-wrap { position: relative; margin-bottom: 15px; }
        .wiz-inp { 
            width: 100%; padding: 16px; padding-left: 44px;
            background: var(--bg-input); border: 2px solid transparent; 
            border-radius: 14px; font-size: 16px; color: var(--text-main); outline: none; 
            transition: 0.2s;
        }
        .wiz-inp:focus { background: var(--bg-card); border-color: var(--accent); box-shadow: 0 0 0 4px var(--accent-glow); }
        .wiz-icon { position: absolute; left: 14px; top: 16px; opacity: 0.4; }
        
        .wiz-item { 
            padding: 14px 10px; border-bottom: 1px solid var(--bg-input); 
            cursor: pointer; font-weight: 500; font-size: 15px;
            display: flex; justify-content: space-between;
        }
        .wiz-item:hover { background: var(--bg-input); border-radius: 8px; border-bottom-color: transparent; }
        .wiz-item::after { content: '‚Ä∫'; color: var(--text-sub); font-weight: bold; }
        
    </style>
</head>
<body>

<div class="container">
    
    <header>
        <h1>–ì—Ä–∞—Ñ—ñ–∫ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Å–≤—ñ—Ç–ª–∞ –¢–µ—Ä–Ω–æ–ø—ñ–ª—åüí°</h1>
        <div class="status-badge">
            <div id="statusDot" class="dot"></div>
            <span id="updateTime">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
        </div>
    </header>

    <div class="actions-grid">
        <a href="https://t.me/Grafik_Tern_bot" target="_blank" class="btn-main btn-tg">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69.01-.03.01-.14-.07-.2-.08-.06-.19-.04-.27-.02-.11.02-1.93 1.23-5.46 3.62-.51.35-.98.52-1.4.51-.46-.01-1.35-.26-2.01-.47-.81-.27-1.44-.41-1.38-.87.03-.24.38-.49 1.03-.75 4.06-1.77 6.77-2.94 8.13-3.51 3.87-1.63 4.67-1.91 5.2-1.91.11 0 .37.03.54.17.14.12.18.28.2.4.02.12.03.36.03.44z"/></svg>
            –ß–∞—Ç-–±–æ—Ç
        </a>
        <button onclick="openWiz()" class="btn-main btn-search">
            üîç –ó–Ω–∞–π—Ç–∏ —á–µ—Ä–≥—É
        </button>
    </div>

    <div class="scroller-container">
        <div class="group-track-wrapper">
            <div class="group-track" id="groupTrack">
                </div>
        </div>
        <div class="scroll-hint">(–ì–æ—Ä—Ç–∞–π—Ç–µ –≤–±—ñ–∫, —â–æ–± –æ–±—Ä–∞—Ç–∏ –≥—Ä—É–ø—É)</div>
    </div>

    <div class="card">
        
        <div class="day-switch">
            <button id="btnToday" class="day-opt active" onclick="setDay('today')">
                –°–¨–û–ì–û–î–ù–Ü
                <span id="dateToday">--.--.--</span>
            </button>
            <button id="btnTomorrow" class="day-opt" onclick="setDay('tomorrow')">
                –ó–ê–í–¢–†–ê
                <span id="dateTomorrow">--.--.--</span>
            </button>
        </div>

        <div id="noDataMsg" class="no-sched-msg">–ì—Ä–∞—Ñ—ñ–∫ –Ω–∞ –∑–∞–≤—Ç—Ä–∞ —â–µ –Ω–µ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ</div>

        <div class="group-display">
            <div class="group-display-label">–í–ê–®–ê –ß–ï–†–ì–ê</div>
            <div class="group-display-inner" id="groupDisplay">--</div>
        </div>

        <div id="scheduleContainer" class="schedule-list">
            <div class="empty-state">–û–±–µ—Ä—ñ—Ç—å —á–µ—Ä–≥—É –∑–≤–µ—Ä—Ö—É üëÜ</div>
        </div>

        <button class="btn-share" onclick="share()">üì§ –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –≥—Ä–∞—Ñ—ñ–∫–æ–º</button>
    </div>

    <button class="accordion-btn" onclick="toggleMatrix()">
        <span>üìÖ</span> –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—É —Ç–∞–±–ª–∏—Ü—é (–≤—Å—ñ —á–µ—Ä–≥–∏)
    </button>
    
    <div id="matrix" class="full-chart">
        <div style="display:flex; margin-bottom:10px; font-size:11px; color:var(--text-sub); padding-left:40px; font-weight:600;">
            <span style="flex:1">00</span><span style="flex:1">06</span><span style="flex:1">12</span><span style="flex:1">18</span>
        </div>
        <div id="matrixContent"></div>
    </div>
    
    <footer>
        <h2>–ü—Ä–æ —Å–µ—Ä–≤—ñ—Å</h2>
        <p>–¶–µ–π –≤–µ–±-—Å–∞–π—Ç –Ω–∞–¥–∞—î –Ω–∞–π–∞–∫—Ç—É–∞–ª—å–Ω—ñ—à–∏–π –≥—Ä–∞—Ñ—ñ–∫ –ø–æ–≥–æ–¥–∏–Ω–Ω–∏—Ö –≤—ñ–¥–∫–ª—é—á–µ–Ω—å (–ì–ü–í) –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó –¥–ª—è —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤ –í–ê–¢ "–¢–µ—Ä–Ω–æ–ø—ñ–ª—å–æ–±–ª–µ–Ω–µ—Ä–≥–æ". –î–∞–Ω—ñ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—é—Ç—å—Å—è –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–∏–º–∏ –¥–∂–µ—Ä–µ–ª–∞–º–∏ —Ç–∞ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º—ñ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É.</p>
        
        <a href="about.html" style="display:inline-block; margin-top:15px; color:var(--accent); text-decoration:none; font-weight:700; border:1px solid var(--accent); padding:8px 16px; border-radius:20px; transition:0.2s;">
            ‚ÑπÔ∏è –ü—Ä–æ –ø—Ä–æ—î–∫—Ç / –ó–≤–æ—Ä–æ—Ç–Ω—ñ–π –∑–≤'—è–∑–æ–∫
        </a>

        <p style="margin-top:20px; font-size:11px;">¬© 2025 Grafik-Svitla-Ternopil. –î–∞–Ω—ñ –º–∞—é—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–∏–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä.</p>
    </footer>>

</div>

<div id="wiz" class="wiz-overlay" onclick="if(event.target===this)closeWiz()">
    <div class="wiz-box">
        <div class="wiz-head">
            <span id="wizTitle">–ü–æ—à—É–∫ —á–µ—Ä–≥–∏</span>
            <span class="wiz-close" onclick="closeWiz()">√ó</span>
        </div>
        <div class="wiz-body">
            <div id="step1">
                <div class="wiz-input-wrap">
                    <span class="wiz-icon">üèô</span>
                    <input id="inpCity" class="wiz-inp" placeholder="–û–±–µ—Ä—ñ—Ç—å –º—ñ—Å—Ç–æ (–Ω–∞–ø—Ä. –¢–µ—Ä–Ω–æ–ø—ñ–ª—å)">
                </div>
                <div id="listCity"></div>
            </div>
            <div id="step2" style="display:none">
                <div class="wiz-input-wrap">
                    <span class="wiz-icon">üõ£</span>
                    <input id="inpStreet" class="wiz-inp" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤—É–ª–∏—Ü—é">
                </div>
                <div id="listStreet"></div>
                <div onclick="closeWiz(); openWiz();" style="text-align:center; padding:15px; color:var(--text-sub); font-size:13px; cursor:pointer;">‚Üê –ù–∞–∑–∞–¥ –¥–æ –≤–∏–±–æ—Ä—É –º—ñ—Å—Ç–∞</div>
            </div>
            <div id="step3" style="display:none">
                <div class="wiz-input-wrap">
                    <span class="wiz-icon">üè†</span>
                    <input id="inpHouse" class="wiz-inp" placeholder="–ù–æ–º–µ—Ä –±—É–¥–∏–Ω–∫—É">
                </div>
                <div id="listHouse"></div>
                <div onclick="setCity(selCity)" style="text-align:center; padding:15px; color:var(--text-sub); font-size:13px; cursor:pointer;">‚Üê –ù–∞–∑–∞–¥ –¥–æ –≤–∏–±–æ—Ä—É –≤—É–ª–∏—Ü—ñ</div>
            </div>
        </div>
    </div>
</div>

<script>
    // === CONFIG ===
    const BASE_URL = 'https://raw.githubusercontent.com/kalyniak-gnostik/Svitlo_Ternopil/main';
    const CACHE = `?v=${Date.now()}`;
    const GROUPS = ["1.1", "1.2", "2.1", "2.2", "3.1", "3.2", "4.1", "4.2", "5.1", "5.2", "6.1", "6.2"];
    const DEFAULT_CITIES = ['–¢–µ—Ä–Ω–æ–ø—ñ–ª—å', '–ß–æ—Ä—Ç–∫—ñ–≤', '–ö—Ä–µ–º–µ–Ω–µ—Ü—å', '–ë–µ—Ä–µ–∂–∞–Ω–∏', '–ó–±–∞—Ä–∞–∂', '–¢–µ—Ä–µ–±–æ–≤–ª—è'];

    // === STATE ===
    let gData = { today: null, tomorrow: null, updated: '' };
    let gAddr = null;
    let currDay = 'today';
    let currGroup = new URLSearchParams(window.location.search).get('group') || localStorage.getItem('myGroup');
    
    // Infinite Scroll State
    let scrollerEl = null;
    let singleSetWidth = 0;

    // === INIT ===
    async function init() {
        // Init scroller immediately
        setupInfiniteScroller();

        try {
            const [sRes, aRes] = await Promise.all([
                fetch(`${BASE_URL}/schedule.json${CACHE}`),
                fetch(`${BASE_URL}/addresses.json${CACHE}`)
            ]);
            
            if(aRes.ok) gAddr = await aRes.json();
            if(sRes.ok) {
                const raw = await sRes.json();
                processData(raw);
            }
        } catch(e) {
            console.error(e);
            document.getElementById('updateTime').innerText = "–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è";
            document.getElementById('statusDot').classList.add('error');
        }
        
        if(currGroup) selectGroup(currGroup);
    }

    // === INFINITE SCROLLER LOGIC (Tripled Buffer) ===
    function setupInfiniteScroller() {
        scrollerEl = document.getElementById('groupTrack');
        scrollerEl.innerHTML = '';
        
        // Render 3 sets: [Left Buffer] [Main Set] [Right Buffer]
        const tripleList = [...GROUPS, ...GROUPS, ...GROUPS];
        
        tripleList.forEach(g => {
            const b = document.createElement('div');
            b.className = 'btn-group';
            b.innerText = g;
            b.dataset.group = g; 
            b.onclick = () => selectGroup(g);
            scrollerEl.appendChild(b);
        });

        // Initialize Physics & Loop Logic after style applied
        setTimeout(() => {
            if(scrollerEl.children.length > 0) {
                const itemW = scrollerEl.children[0].offsetWidth + 12; // 56px + 12px gap
                singleSetWidth = itemW * GROUPS.length;
                
                // Start in the middle set
                scrollerEl.scrollLeft = singleSetWidth;
                
                scrollerEl.addEventListener('scroll', handleLoopScroll);
                enableMomentum(scrollerEl);
            }
        }, 50);
    }

    function handleLoopScroll() {
        if (!singleSetWidth) return;
        const current = scrollerEl.scrollLeft;
        
        // Loop Logic: If we scroll too far left/right, jump to center
        if (current < singleSetWidth / 2) {
            scrollerEl.scrollLeft += singleSetWidth;
        } else if (current > singleSetWidth * 1.5) {
            scrollerEl.scrollLeft -= singleSetWidth;
        }
    }

    function enableMomentum(el) {
        let isDown = false;
        let startX, scrollLeft;
        let velX = 0;
        let animationID;

        el.addEventListener('mousedown', e => {
            isDown = true;
            el.classList.add('active');
            startX = e.pageX - el.offsetLeft;
            scrollLeft = el.scrollLeft;
            cancelAnimationFrame(animationID);
        });
        el.addEventListener('mouseleave', () => { isDown = false; el.classList.remove('active'); });
        el.addEventListener('mouseup', () => { 
            isDown = false; 
            el.classList.remove('active');
            requestAnimationFrame(inertia);
        });
        el.addEventListener('mousemove', e => {
            if (!isDown) return;
            e.preventDefault();
            const x = e.pageX - el.offsetLeft;
            const walk = (x - startX) * 1.5;
            velX = (scrollLeft - walk) - el.scrollLeft; // Calc velocity
            el.scrollLeft = scrollLeft - walk;
        });

        function inertia() {
            if (Math.abs(velX) < 0.1) return;
            el.scrollLeft += velX;
            velX *= 0.95; // Friction
            handleLoopScroll(); // Ensure loop check during inertia
            animationID = requestAnimationFrame(inertia);
        }
    }

    function selectGroup(g) {
        currGroup = g;
        localStorage.setItem('myGroup', g);
        
        // Update URL
        const newUrl = `${window.location.pathname}?group=${g}`;
        window.history.pushState({path: newUrl}, '', newUrl);

        // Highlight ALL instances of this group in the scroller
        document.querySelectorAll('.btn-group').forEach(b => {
            if(b.dataset.group === g) b.classList.add('active');
            else b.classList.remove('active');
        });

        renderCard();
    }

    // === DATA PROCESSING ===
    function processData(raw) {
        const now = new Date();
        const dToday = fmtDateAPI(now);
        const dTom = fmtDateAPI(new Date(now.getTime() + 86400000));

        gData.updated = raw.updated_at.split(' ')[1] || raw.updated_at;
        
        if(raw.today?.date === dToday) gData.today = raw.today;
        else if(raw.today?.date === dTom) gData.tomorrow = raw.today;
        
        if(raw.tomorrow?.date === dTom) gData.tomorrow = raw.tomorrow;
        else if(raw.tomorrow?.date === dToday && !gData.today) gData.today = raw.tomorrow;

        // Display
        document.getElementById('updateTime').innerText = `–û–Ω–æ–≤–ª–µ–Ω–æ: ${gData.updated}`;
        
        // Date formatting dd.mm.yyyy
        document.getElementById('dateToday').innerText = gData.today ? fmtDateDisplay(gData.today.date) : fmtDateDisplay(dToday);
        document.getElementById('dateTomorrow').innerText = gData.tomorrow ? fmtDateDisplay(gData.tomorrow.date) : fmtDateDisplay(dTom);
        
        if(!gData.tomorrow) document.getElementById('btnTomorrow').classList.add('disabled');
        
        if(currGroup) selectGroup(currGroup); // re-trigger render
    }

    // === MODIFIED FUNCTION TO SHOW TEXT INSTEAD OF ALERT ===
    function setDay(day) {
        const msg = document.getElementById('noDataMsg');
        
        if(day === 'tomorrow' && !gData.tomorrow) {
            // Show message under buttons
            msg.style.display = 'block';
            return;
        }

        // Hide message if everything is OK
        msg.style.display = 'none';

        currDay = day;
        document.getElementById('btnToday').classList.toggle('active', day === 'today');
        document.getElementById('btnTomorrow').classList.toggle('active', day === 'tomorrow');
        renderCard();
    }

    function renderCard() {
        const display = document.getElementById('groupDisplay');
        const list = document.getElementById('scheduleContainer');
        
        display.innerText = currGroup || '--';
        
        if(!currGroup) return;

        const dayData = gData[currDay];
        if(!dayData || !dayData.data[currGroup]) {
            list.innerHTML = `<div class="empty-state">–î–∞–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ</div>`;
            return;
        }

        const ranges = calcRanges(dayData.data[currGroup]);
        let html = '';
        ranges.forEach(r => {
            let cls = 'on', statusText = '–°–í–Ü–¢–õ–û –Ñ';
            if(r.type === 'off') { cls = 'off'; statusText = '–í–Ü–î–ö–õ–Æ–ß–ï–ù–ù–Ø'; }
            if(r.type === 'maybe') { cls = 'maybe'; statusText = '–ú–û–ñ–õ–ò–í–û'; }
            
            html += `
                <div class="row ${cls}">
                    <div class="time-box">
                        <div>${r.start}</div>
                        <div style="font-size:10px; opacity:0.6; margin:2px 0;">‚Üì</div>
                        <div>${r.end}</div>
                    </div>
                    <div class="status-box">
                        <div>
                            <div>${statusText}</div>
                            <div class="row-dur">${r.dur}</div>
                        </div>
                        <div style="font-size:20px">${r.type === 'off' ? '‚ö°Ô∏è' : (r.type === 'maybe' ? '‚ö†Ô∏è' : 'üí°')}</div>
                    </div>
                </div>`;
        });
        list.innerHTML = html;
        if(document.getElementById('matrix').classList.contains('open')) renderMatrix();
    }

    // === UTILS ===
    // Formats date for API check (DD.MM.YYYY)
    function fmtDateAPI(d) {
        return `${String(d.getDate()).padStart(2,'0')}.${String(d.getMonth()+1).padStart(2,'0')}.${d.getFullYear()}`;
    }
    
    // Formats date string to DD.MM.YYYY
    function fmtDateDisplay(dateStr) {
        // If API returns DD.MM.YYYY, return as is. If API differs, adjust here.
        // Assuming API sends DD.MM.YYYY
        if(!dateStr) return '--.--.----';
        // Add Year if missing (fallback)
        if(dateStr.length <= 5) {
            const y = new Date().getFullYear();
            return `${dateStr}.${y}`;
        }
        return dateStr;
    }

    function calcRanges(sched) {
        const times = Object.keys(sched).sort();
        let res = [], start = null, cur = null;
        for (let t of times) {
            let type = sched[t];
            if (type !== cur) {
                if (cur) res.push({start, end:t, type:cur, dur: getDur(start, t)});
                start = t; cur = type;
            }
        }
        if (cur) res.push({start, end:'24:00', type:cur, dur: getDur(start, '24:00')});
        return res;
    }

    function getDur(s, e) {
        const [h1, m1] = s.split(':').map(Number);
        const [h2, m2] = e.split(':').map(Number);
        let min = (h2*60+m2) - (h1*60+m1);
        if(min < 0) min += 1440;
        const h = Math.floor(min/60), m = min%60;
        return h>0 ? (m>0 ? `${h}–≥ ${m}—Ö–≤` : `${h} –≥–æ–¥`) : `${m} —Ö–≤`;
    }

    function share() {
        if(!currGroup) return;
        const text = `–ì—Ä–∞—Ñ—ñ–∫ —á–µ—Ä–≥–∏ ${currGroup}. ${window.location.href}`;
        if(navigator.share) navigator.share({title:'–°–≤—ñ—Ç–ª–æ', text, url: window.location.href});
        else { navigator.clipboard.writeText(window.location.href); alert('–ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'); }
    }

    // === MATRIX & WIZARD ===
    function renderMatrix() {
        const div = document.getElementById('matrixContent');
        const dayData = gData[currDay];
        if(!dayData) { div.innerHTML = '–î–∞–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ'; return; }
        
        let h = '';
        GROUPS.forEach(g => {
            h += `<div class="chart-row" onclick="selectGroup('${g}')">
                <div class="lbl" style="${g===currGroup?'color:var(--accent)':''}">${g}</div>
                <div class="bar">`;
            Object.keys(dayData.data[g]).sort().forEach(t => {
                const s = dayData.data[g][t];
                let c = 'u';
                if(s==='on') c='on'; if(s==='off') c='off'; if(s==='maybe') c='maybe';
                h += `<div class="cell ${c}"></div>`;
            });
            h += `</div></div>`;
        });
        div.innerHTML = h;
    }
    function toggleMatrix() {
        const m = document.getElementById('matrix');
        m.classList.toggle('open');
        if(m.classList.contains('open')) {
            renderMatrix();
            m.scrollIntoView({behavior: 'smooth', block: 'start'});
        }
    }
    
    // Search Wizard
    function openWiz() { 
        if(!gAddr) { alert('–ë–∞–∑–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è...'); return; }
        document.getElementById('wiz').style.display = 'flex';
        renderList('listCity', DEFAULT_CITIES, setCity);
    }
    function closeWiz() { 
        document.getElementById('wiz').style.display = 'none'; 
        document.getElementById('step1').style.display = 'block';
        document.getElementById('step2').style.display = 'none';
        document.getElementById('step3').style.display = 'none';
        document.getElementById('inpCity').value = '';
    }
    function setupSearch(inpId, listId, dataFn, cb) {
        document.getElementById(inpId).oninput = (e) => {
            const v = e.target.value.toLowerCase();
            const list = dataFn().filter(x => x.toLowerCase().includes(v));
            renderList(listId, list, cb);
        };
    }
    function renderList(id, arr, cb) {
        const el = document.getElementById(id); el.innerHTML = '';
        if(arr.length === 0) el.innerHTML = '<div style="padding:15px; color:var(--text-sub); font-style:italic">–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</div>';
        arr.slice(0,50).forEach(x => {
            const d = document.createElement('div');
            d.className = 'wiz-item'; d.innerText = x;
            d.onclick = () => cb(x);
            el.appendChild(d);
        });
    }
    let selCity = '';
    function setCity(c) {
        selCity = c; document.getElementById('inpCity').value = c;
        document.getElementById('step1').style.display = 'none';
        document.getElementById('step2').style.display = 'block';
        document.getElementById('wizTitle').innerText = '–í—É–ª–∏—Ü—è';
        const streets = gAddr.filter(x => x.c === c).map(x => x.s);
        setupSearch('inpStreet', 'listStreet', () => [...new Set(streets)], setStreet);
        renderList('listStreet', [...new Set(streets)].sort(), setStreet);
    }
    function setStreet(s) {
        document.getElementById('inpStreet').value = s;
        document.getElementById('step2').style.display = 'none';
        document.getElementById('step3').style.display = 'block';
        document.getElementById('wizTitle').innerText = '–ë—É–¥–∏–Ω–æ–∫';
        const houses = gAddr.filter(x => x.c === selCity && x.s === s);
        if([...new Set(houses.map(x=>x.g))].length === 1) { finish(houses[0].g); return; }
        setupSearch('inpHouse', 'listHouse', () => houses.map(x=>x.h), h => {
            const f = houses.find(x => x.h === h); if(f) finish(f.g);
        });
        renderList('listHouse', houses.map(x=>x.h).sort((a,b)=>a.localeCompare(b,undefined,{numeric:true})), h => {
            const f = houses.find(x => x.h === h); if(f) finish(f.g);
        });
    }
    function finish(g) { closeWiz(); selectGroup(g); }

    init();
</script>

</body>
</html>


